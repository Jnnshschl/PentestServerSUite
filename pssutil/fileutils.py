from json import dumps, loads
from os import makedirs
from pathlib import Path
from uuid import uuid4


def load_json(file_path):
    if not file_path.parent.exists():
        makedirs(file_path.parent)

    if file_path.exists():
        try:
            with open(file_path, "r") as f:
                return loads(f.read())
        except:
            return None
    else:
        return {}


def save_json(file_path, obj):
    if not file_path.parent.exists():
        makedirs(file_path.parent)

    try:
        with open(file_path, "w+") as f:
            f.write(dumps(obj, indent=2, sort_keys=True))
            return True
    except:
        pass
    return False


def generate_random_filename(folder: Path, ext: str, lenght: int = 8):
    if not folder.exists():
        makedirs()

    filename = abs(hash(uuid4().hex)) % (10**lenght)
    return Path(folder, f"{filename}{ext}")
