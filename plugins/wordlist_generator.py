import itertools
import logging as logger
from datetime import datetime

from pssutil.cmdutils import CmdLenValidator


def add_cmd(pm, cmd):
    os_handler = cmd.add(["wordlist"])
    os_handler.add(["usernames"], CmdLenValidator(generate_usernames, 1, ["name", "lastname"]))
    os_handler.add(["companypasswords"], CmdLenValidator(generate_companypasswords, 2, ["name", "establishment year", "initials"]))


def generate_usernames(args):
    if len(args) > 1:
        for name in generate_username_list_simple(args[0], args[1]):
            print(name)
    else:
        logger.error("not implemented")


def generate_companypasswords(args):
    for pw in generate_password_list_company(args[0], args[1], args[2] if len(args) > 2 else ""):
        print(pw)


def generate_password_list_company(company_name, company_initials, year_established):
    common_passwords = [
        "Summer",
        "summer",
        "Winter",
        "winter",
        str(datetime.now().year),
        str(datetime.now().year - 1),
        str(datetime.now().year + 1),
        "password",
        "123456",
        "12345678",
        "qwerty",
        "abc123",
        "1234567",
        "password1",
        "12345",
        "123456789",
        "1234",
        "1234567890",
        "letmein",
        "password123",
        "welcome",
        "monkey",
        "abc123",
        "admin",
        "passw0rd",
        "trustno1",
        "1234567",
        "12345678",
        "123456789",
        "password!",
        "1234",
        "password1!",
        "12345",
        "1234567890",
        "123456789!",
        "1234567890!",
        "iloveyou",
        "password123!",
        company_name,
        company_initials,
        str(year_established),
        str(year_established)[-2:],
        str(year_established)[-2:] + company_initials,
        company_name.lower(),
        company_name.upper(),
        company_name.capitalize(),
        company_initials.lower(),
        company_initials.upper(),
        company_initials.capitalize(),
    ]

    return list(set(["".join(p) for p in itertools.permutations(common_passwords, 2)]))


def generate_username_list_simple(first_name, last_name):
    first_name_lower = first_name.lower()
    last_name_lower = last_name.lower()
    first_name_upper = first_name.upper()
    last_name_upper = last_name.upper()

    return [
        first_name_lower,
        last_name_lower,
        first_name_lower + last_name_lower,
        last_name_lower + first_name_lower,
        first_name_lower + "." + last_name_lower,
        last_name_lower + "." + first_name_lower,
        first_name_lower + "_" + last_name_lower,
        last_name_lower + "_" + first_name_lower,
        first_name_lower + "-" + last_name_lower,
        last_name_lower + "-" + first_name_lower,
        first_name_lower + last_name_lower[0],
        last_name_lower + first_name_lower[0],
        first_name_lower + "-" + last_name_lower[0],
        last_name_lower + "-" + first_name_lower[0],
        first_name_lower[0] + last_name_lower,
        last_name_lower[0] + first_name_lower,
        first_name_lower[0] + "." + last_name_lower,
        last_name_lower[0] + "." + first_name_lower,
        first_name_lower[0] + "_" + last_name_lower,
        last_name_lower[0] + "_" + first_name_lower,
        first_name_lower + last_name_lower[:2],
        last_name_lower + first_name_lower[:2],
        first_name_lower[:2] + last_name_lower,
        last_name_lower[:2] + first_name_lower,
        first_name_lower[:2] + "." + last_name_lower,
        last_name_lower[:2] + "." + first_name_lower,
        first_name_lower[:2] + "_" + last_name_lower,
        last_name_lower[:2] + "_" + first_name_lower,
        first_name_lower[:2] + "-" + last_name_lower,
        last_name_lower[:2] + "-" + first_name_lower,
        first_name_lower + "123",
        last_name_lower + "123",
        first_name_lower + last_name_lower + "123",
        last_name_lower + first_name_lower + "123",
        first_name_lower + "123" + last_name_lower,
        last_name_lower + "123" + first_name_lower,
        first_name_lower + "*" + last_name_lower,
        last_name_lower + "*" + first_name_lower,
        first_name_lower + "$" + last_name_lower,
        last_name_lower + "$" + first_name_lower,
        first_name_lower + "#" + last_name_lower,
        last_name_lower + "#" + first_name_lower,
        first_name_lower + "%" + last_name_lower,
        last_name_lower + "%" + first_name_lower,
        first_name_lower + "@" + last_name_lower,
        last_name_lower + "@" + first_name_lower,
        first_name_lower + "!" + last_name_lower,
        last_name_lower + "!" + first_name_lower,
        first_name_lower + "&" + last_name_lower,
        last_name_lower + "&" + first_name_lower,
        first_name_lower + "~" + last_name_lower,
        last_name_lower + "~" + first_name_lower,
        first_name_lower + "`" + last_name_lower,
        last_name_lower + "`" + first_name_lower,
        first_name_lower + "^" + last_name_lower,
        last_name_lower + "^" + first_name_lower,
        first_name_upper,
        last_name_upper,
        first_name_upper + last_name_upper,
        last_name_upper + first_name_upper,
        first_name_upper + "." + last_name_upper,
        last_name_upper + "." + first_name_upper,
        first_name_upper + "_" + last_name_upper,
        last_name_upper + "_" + first_name_upper,
        first_name_upper + "-" + last_name_upper,
        last_name_upper + "-" + first_name_upper,
        first_name_upper + last_name_upper[0],
        last_name_upper + first_name_upper[0],
        first_name_upper + "-" + last_name_upper[0],
        last_name_upper + "-" + first_name_upper[0],
        first_name_upper[0] + last_name_upper,
        last_name_upper[0] + first_name_upper,
        first_name_upper[0] + "." + last_name_upper,
        last_name_upper[0] + "." + first_name_upper,
        first_name_upper[0] + "_" + last_name_upper,
        last_name_upper[0] + "_" + first_name_upper,
        first_name_upper + last_name_upper[:2],
        last_name_upper + first_name_upper[:2],
        first_name_upper[:2] + last_name_upper,
        last_name_upper[:2] + first_name_upper,
        first_name_upper[:2] + "." + last_name_upper,
        last_name_upper[:2] + "." + first_name_upper,
        first_name_upper[:2] + "_" + last_name_upper,
        last_name_upper[:2] + "_" + first_name_upper,
        first_name_upper[:2] + "-" + last_name_upper,
        last_name_upper[:2] + "-" + first_name_upper,
        first_name_upper + "123",
        last_name_upper + "123",
        first_name_upper + last_name_upper + "123",
        last_name_upper + first_name_upper + "123",
        first_name_upper + "123" + last_name_upper,
        last_name_upper + "123" + first_name_upper,
        first_name_upper + "*" + last_name_upper,
        last_name_upper + "*" + first_name_upper,
        first_name_upper + "$" + last_name_upper,
        last_name_upper + "$" + first_name_upper,
        first_name_upper + "#" + last_name_upper,
        last_name_upper + "#" + first_name_upper,
        first_name_upper + "%" + last_name_upper,
        last_name_upper + "%" + first_name_upper,
        first_name_upper + "@" + last_name_upper,
        last_name_upper + "@" + first_name_upper,
        first_name_upper + "!" + last_name_upper,
        last_name_upper + "!" + first_name_upper,
        first_name_upper + "&" + last_name_upper,
        last_name_upper + "&" + first_name_upper,
        first_name_upper + "~" + last_name_upper,
        last_name_upper + "~" + first_name_upper,
        first_name_upper + "`" + last_name_upper,
        last_name_upper + "`" + first_name_upper,
        first_name_upper + "^" + last_name_upper,
        last_name_upper + "^" + first_name_upper,
        first_name_lower[0].lower() + first_name_lower[1:] + last_name_lower,
        last_name_lower[0].lower() + last_name_lower[1:] + first_name_lower,
        first_name_lower[0].lower() + first_name_lower[1:] + "." + last_name_lower,
        last_name_lower[0].lower() + last_name_lower[1:] + "." + first_name_lower,
        first_name_lower[0].lower() + first_name_lower[1:] + "_" + last_name_lower,
        last_name_lower[0].lower() + last_name_lower[1:] + "_" + first_name_lower,
        first_name_lower[0].lower() + first_name_lower[1:] + "-" + last_name_lower,
        last_name_lower[0].lower() + last_name_lower[1:] + "-" + first_name_lower,
        first_name_lower[0].upper() + first_name_lower[1:] + last_name_lower,
        last_name_lower[0].upper() + last_name_lower[1:] + first_name_lower,
        first_name_lower[0].upper() + first_name_lower[1:] + "." + last_name_lower,
        last_name_lower[0].upper() + last_name_lower[1:] + "." + first_name_lower,
        first_name_lower[0].upper() + first_name_lower[1:] + "_" + last_name_lower,
        last_name_lower[0].upper() + last_name_lower[1:] + "_" + first_name_lower,
        first_name_lower[0].upper() + first_name_lower[1:] + "-" + last_name_lower,
        last_name_lower[0].upper() + last_name_lower[1:] + "-" + first_name_lower,
    ]
